<!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ú†Øª Ù†Ø§Ø´Ù†Ø§Ø³ Ø§Ù…Ù†</title>
    <style>
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
            font-family: 'Vazir', 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        @font-face {
            font-family: 'Vazir';
            src: url('https://cdn.jsdelivr.net/gh/rastikerdar/vazir-font@v30.1.0/dist/Vazir.woff2') format('woff2');
        }
        
        body {
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
            min-height: 100vh;
            padding: 20px;
            color: #e6e6e6;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
        }
        
        /* Ù¾Ù†Ù„ Ø§Ø¯Ù…ÛŒÙ† Ù…Ø®ÙÛŒ Ø¨Ø§ Ø¯Ø³ØªØ±Ø³ÛŒ Ø§Ù…Ù† */
        .admin-access {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: rgba(0, 0, 0, 0.95);
            backdrop-filter: blur(10px);
            border-radius: 15px;
            padding: 40px;
            width: 400px;
            display: none;
            z-index: 9999;
            box-shadow: 0 0 50px rgba(0, 150, 255, 0.3);
            border: 2px solid #0099ff;
        }
        
        .admin-access.show {
            display: block;
            animation: fadeIn 0.3s ease;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translate(-50%, -50%) scale(0.9); }
            to { opacity: 1; transform: translate(-50%, -50%) scale(1); }
        }
        
        .admin-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.8);
            z-index: 9998;
            display: none;
        }
        
        .admin-overlay.show {
            display: block;
        }
        
        .card {
            background: rgba(25, 25, 35, 0.9);
            border-radius: 20px;
            padding: 40px;
            box-shadow: 0 15px 35px rgba(0, 0, 0, 0.5);
            margin-bottom: 30px;
            border: 1px solid rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
        }
        
        h1 {
            text-align: center;
            color: #ffffff;
            margin-bottom: 15px;
            font-size: 2.8rem;
            background: linear-gradient(90deg, #0099ff, #00ffcc);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            text-shadow: 0 0 20px rgba(0, 153, 255, 0.3);
        }
        
        .subtitle {
            text-align: center;
            color: #a0a0a0;
            margin-bottom: 40px;
            font-size: 1.2rem;
            line-height: 1.6;
        }
        
        .tabs {
            display: flex;
            justify-content: center;
            margin-bottom: 40px;
            background: rgba(40, 40, 60, 0.7);
            border-radius: 12px;
            overflow: hidden;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .tab {
            flex: 1;
            padding: 20px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s;
            font-weight: 600;
            font-size: 1.1rem;
            position: relative;
            overflow: hidden;
        }
        
        .tab.active {
            background: linear-gradient(90deg, #0099ff, #00ccff);
            color: white;
            box-shadow: 0 0 15px rgba(0, 153, 255, 0.5);
        }
        
        .tab:not(.active):hover {
            background: rgba(255, 255, 255, 0.05);
        }
        
        .form-container {
            display: none;
            animation: slideUp 0.4s ease;
        }
        
        @keyframes slideUp {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .form-container.active {
            display: block;
        }
        
        .form-group {
            margin-bottom: 25px;
        }
        
        label {
            display: block;
            margin-bottom: 10px;
            font-weight: 600;
            color: #ffffff;
            font-size: 1.1rem;
        }
        
        input, select, textarea {
            width: 100%;
            padding: 15px 20px;
            background: rgba(30, 30, 40, 0.8);
            border: 2px solid rgba(255, 255, 255, 0.1);
            border-radius: 10px;
            font-size: 16px;
            transition: all 0.3s;
            color: white;
        }
        
        input:focus, select:focus, textarea:focus {
            border-color: #0099ff;
            outline: none;
            box-shadow: 0 0 15px rgba(0, 153, 255, 0.3);
        }
        
        .btn {
            background: linear-gradient(90deg, #0099ff, #00ccff);
            color: white;
            border: none;
            padding: 16px 30px;
            border-radius: 10px;
            cursor: pointer;
            font-size: 18px;
            font-weight: 600;
            transition: all 0.3s;
            display: block;
            width: 100%;
            position: relative;
            overflow: hidden;
        }
        
        .btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 10px 20px rgba(0, 153, 255, 0.4);
        }
        
        .btn:active {
            transform: translateY(0);
        }
        
        .btn-secondary {
            background: linear-gradient(90deg, #666, #888);
        }
        
        .btn-danger {
            background: linear-gradient(90deg, #ff416c, #ff4b2b);
        }
        
        .btn-success {
            background: linear-gradient(90deg, #00b09b, #96c93d);
        }
        
        .chat-container {
            display: flex;
            flex-direction: column;
            height: 70vh;
            display: none;
        }
        
        .chat-header {
            background: linear-gradient(90deg, #0099ff, #00ccff);
            color: white;
            padding: 20px;
            border-radius: 15px 15px 0 0;
            display: flex;
            justify-content: space-between;
            align-items: center;
            box-shadow: 0 5px 15px rgba(0, 153, 255, 0.3);
        }
        
        .chat-messages {
            flex: 1;
            overflow-y: auto;
            padding: 25px;
            background: rgba(20, 20, 30, 0.9);
            border-left: 1px solid rgba(255, 255, 255, 0.05);
            border-right: 1px solid rgba(255, 255, 255, 0.05);
        }
        
        /* Ø§Ø³Ú©Ø±ÙˆÙ„ Ø¨Ø§Ø± Ø²ÛŒØ¨Ø§ */
        .chat-messages::-webkit-scrollbar {
            width: 8px;
        }
        
        .chat-messages::-webkit-scrollbar-track {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 10px;
        }
        
        .chat-messages::-webkit-scrollbar-thumb {
            background: linear-gradient(180deg, #0099ff, #00ccff);
            border-radius: 10px;
        }
        
        .message {
            margin-bottom: 20px;
            padding: 15px 20px;
            border-radius: 18px;
            max-width: 75%;
            word-wrap: break-word;
            position: relative;
            animation: messageAppear 0.3s ease;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
        }
        
        @keyframes messageAppear {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .message.sent {
            background: linear-gradient(135deg, #0099ff, #00ccff);
            color: white;
            margin-left: auto;
            border-bottom-right-radius: 5px;
        }
        
        .message.received {
            background: linear-gradient(135deg, #2a2a3a, #3a3a4a);
            color: #ffffff;
            margin-right: auto;
            border-bottom-left-radius: 5px;
        }
        
        .message-info {
            font-size: 12px;
            opacity: 0.8;
            margin-top: 8px;
            display: flex;
            justify-content: space-between;
        }
        
        .message-sender {
            font-weight: bold;
            font-size: 14px;
            margin-bottom: 5px;
            display: flex;
            align-items: center;
        }
        
        .message-sender .badge {
            background: #ff416c;
            color: white;
            font-size: 10px;
            padding: 2px 8px;
            border-radius: 10px;
            margin-right: 8px;
        }
        
        .chat-input {
            display: flex;
            padding: 20px;
            background: rgba(25, 25, 35, 0.9);
            border-radius: 0 0 15px 15px;
            border-top: 1px solid rgba(255, 255, 255, 0.1);
            gap: 15px;
        }
        
        .chat-input textarea {
            flex: 1;
            background: rgba(30, 30, 40, 0.8);
            border: 2px solid rgba(255, 255, 255, 0.1);
            border-radius: 12px;
            resize: none;
            height: 70px;
            font-size: 16px;
            padding: 15px;
            transition: all 0.3s;
        }
        
        .chat-input textarea:focus {
            border-color: #0099ff;
            box-shadow: 0 0 20px rgba(0, 153, 255, 0.2);
        }
        
        .send-btn {
            background: linear-gradient(135deg, #0099ff, #00ccff);
            color: white;
            border: none;
            border-radius: 12px;
            padding: 0 30px;
            cursor: pointer;
            font-weight: 600;
            font-size: 18px;
            transition: all 0.3s;
            min-width: 100px;
        }
        
        .send-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 10px 20px rgba(0, 153, 255, 0.4);
        }
        
        .user-info {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 20px;
            background: rgba(40, 40, 60, 0.7);
            border-radius: 15px;
            margin-bottom: 25px;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .avatar {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            background: linear-gradient(135deg, #0099ff, #00ccff);
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            font-size: 22px;
            box-shadow: 0 5px 15px rgba(0, 153, 255, 0.4);
        }
        
        .logout-btn {
            background: linear-gradient(135deg, #ff416c, #ff4b2b);
            color: white;
            border: none;
            padding: 12px 25px;
            border-radius: 10px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s;
        }
        
        .logout-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 10px 20px rgba(255, 65, 108, 0.4);
        }
        
        .notification {
            position: fixed;
            bottom: 30px;
            left: 50%;
            transform: translateX(-50%);
            background: linear-gradient(135deg, #00b09b, #96c93d);
            color: white;
            padding: 20px 30px;
            border-radius: 12px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
            z-index: 1001;
            display: none;
            max-width: 500px;
            text-align: center;
            font-weight: 600;
        }
        
        .notification.show {
            display: block;
            animation: slideInUp 0.3s ease, fadeOut 0.3s ease 2.7s forwards;
        }
        
        @keyframes slideInUp {
            from { opacity: 0; transform: translateX(-50%) translateY(20px); }
            to { opacity: 1; transform: translateX(-50%) translateY(0); }
        }
        
        @keyframes fadeOut {
            from { opacity: 1; }
            to { opacity: 0; }
        }
        
        .online-users-panel {
            background: rgba(40, 40, 60, 0.8);
            border-radius: 15px;
            padding: 25px;
            margin-bottom: 25px;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .online-users-title {
            font-size: 1.3rem;
            margin-bottom: 20px;
            color: #00ccff;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .online-users-list {
            display: flex;
            flex-wrap: wrap;
            gap: 15px;
        }
        
        .online-user {
            display: flex;
            align-items: center;
            background: rgba(30, 30, 40, 0.8);
            padding: 10px 20px;
            border-radius: 25px;
            border: 1px solid rgba(0, 153, 255, 0.3);
        }
        
        .online-user-avatar {
            width: 35px;
            height: 35px;
            border-radius: 50%;
            background: linear-gradient(135deg, #00b09b, #96c93d);
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            margin-left: 10px;
        }
        
        .status-indicator {
            width: 10px;
            height: 10px;
            border-radius: 50%;
            background: #00ff00;
            margin-left: 10px;
            box-shadow: 0 0 10px #00ff00;
            animation: pulse 2s infinite;
        }
        
        @keyframes pulse {
            0% { opacity: 1; }
            50% { opacity: 0.5; }
            100% { opacity: 1; }
        }
        
        .admin-badge {
            position: fixed;
            top: 20px;
            right: 20px;
            background: linear-gradient(135deg, #ff416c, #ff4b2b);
            color: white;
            padding: 10px 20px;
            border-radius: 25px;
            font-weight: bold;
            cursor: pointer;
            z-index: 100;
            box-shadow: 0 5px 20px rgba(255, 65, 108, 0.4);
            transition: all 0.3s;
            border: 2px solid rgba(255, 255, 255, 0.2);
        }
        
        .admin-badge:hover {
            transform: scale(1.05);
            box-shadow: 0 8px 25px rgba(255, 65, 108, 0.6);
        }
        
        .admin-panel {
            background: rgba(0, 0, 0, 0.95);
            border-radius: 20px;
            padding: 30px;
            margin-top: 30px;
            border: 2px solid #ff416c;
            display: none;
        }
        
        .admin-panel.show {
            display: block;
            animation: slideDown 0.5s ease;
        }
        
        @keyframes slideDown {
            from { opacity: 0; transform: translateY(-20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .admin-section {
            margin-bottom: 30px;
            padding-bottom: 30px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .admin-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
        }
        
        .admin-table th, .admin-table td {
            padding: 15px;
            text-align: right;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .admin-table th {
            background: rgba(255, 65, 108, 0.2);
            font-weight: 600;
            color: #ffccd5;
        }
        
        .admin-table tr:hover {
            background: rgba(255, 255, 255, 0.05);
        }
        
        .admin-actions {
            display: flex;
            gap: 15px;
            flex-wrap: wrap;
            margin-top: 20px;
        }
        
        .typing-indicator {
            display: flex;
            align-items: center;
            padding: 10px 20px;
            background: rgba(40, 40, 60, 0.8);
            border-radius: 20px;
            margin-bottom: 15px;
            width: fit-content;
            animation: fadeIn 0.3s ease;
        }
        
        .typing-dots {
            display: flex;
            gap: 4px;
            margin-right: 10px;
        }
        
        .typing-dot {
            width: 8px;
            height: 8px;
            border-radius: 50%;
            background: #00ccff;
            animation: typing 1.4s infinite ease-in-out;
        }
        
        .typing-dot:nth-child(1) { animation-delay: -0.32s; }
        .typing-dot:nth-child(2) { animation-delay: -0.16s; }
        
        @keyframes typing {
            0%, 80%, 100% { transform: scale(0.6); opacity: 0.6; }
            40% { transform: scale(1); opacity: 1; }
        }
        
        .message-time {
            font-size: 11px;
            opacity: 0.7;
        }
        
        @media (max-width: 768px) {
            .card {
                padding: 25px;
            }
            
            h1 {
                font-size: 2.2rem;
            }
            
            .chat-container {
                height: 65vh;
            }
            
            .online-users-list {
                justify-content: center;
            }
            
            .admin-access {
                width: 90%;
                padding: 30px;
            }
            
            .admin-table th, .admin-table td {
                padding: 10px;
                font-size: 14px;
            }
        }
        
        @media (max-width: 480px) {
            .card {
                padding: 20px;
            }
            
            h1 {
                font-size: 1.8rem;
            }
            
            .user-info {
                flex-direction: column;
                gap: 15px;
            }
            
            .chat-input {
                flex-direction: column;
            }
            
            .send-btn {
                width: 100%;
                height: 50px;
            }
        }
    </style>
</head>
<body>
    <!-- Ø¨Ø®Ø´ Ø¯Ø³ØªØ±Ø³ÛŒ Ø§Ø¯Ù…ÛŒÙ† (Ù…Ø®ÙÛŒ) -->
    <div class="admin-overlay" id="adminOverlay"></div>
    <div class="admin-access" id="adminAccess">
        <h2 style="text-align: center; margin-bottom: 30px; color: #ff416c;">ğŸ” Ø¯Ø³ØªØ±Ø³ÛŒ Ù…Ø¯ÛŒØ±ÛŒØª</h2>
        <div class="form-group">
            <label for="adminUsername">Ù†Ø§Ù… Ú©Ø§Ø±Ø¨Ø±ÛŒ Ø§Ø¯Ù…ÛŒÙ†</label>
            <input type="text" id="adminUsername" placeholder="Ù†Ø§Ù… Ú©Ø§Ø±Ø¨Ø±ÛŒ Ø§Ø¯Ù…ÛŒÙ†">
        </div>
        <div class="form-group">
            <label for="adminPassword">Ø±Ù…Ø² Ø¹Ø¨ÙˆØ± Ø§Ø¯Ù…ÛŒÙ†</label>
            <input type="password" id="adminPassword" placeholder="Ø±Ù…Ø² Ø¹Ø¨ÙˆØ± Ø§Ø¯Ù…ÛŒÙ†">
        </div>
        <div class="form-group">
            <label for="adminSecret">Ú©Ø¯ Ù…Ø®ÙÛŒ</label>
            <input type="password" id="adminSecret" placeholder="Ú©Ø¯ Ù…Ø®ÙÛŒ Ø³ÛŒØ³ØªÙ…">
        </div>
        <button class="btn btn-danger" id="adminLoginBtn">ÙˆØ±ÙˆØ¯ Ø¨Ù‡ Ù¾Ù†Ù„ Ù…Ø¯ÛŒØ±ÛŒØª</button>
        <button class="btn btn-secondary" id="closeAdminBtn" style="margin-top: 15px;">Ø§Ù†ØµØ±Ø§Ù</button>
    </div>
    
    <!-- Ù†Ø´Ø§Ù†Ú¯Ø± Ø§Ø¯Ù…ÛŒÙ† (ÙÙ‚Ø· Ø¨Ø±Ø§ÛŒ Ø§Ø¯Ù…ÛŒÙ† ÙˆØ§Ù‚Ø¹ÛŒ) -->
    <div class="admin-badge" id="adminBadge" style="display: none;">ğŸ”§ Ù…Ø¯ÛŒØ±ÛŒØª Ø³ÛŒØ³ØªÙ…</div>
    
    <div class="container">
        <div class="card">
            <h1>ğŸ”’ Ú†Øª Ù†Ø§Ø´Ù†Ø§Ø³ Ø§Ù…Ù†</h1>
            <p class="subtitle">Ú¯ÙØªÚ¯ÙˆÛŒ Ú©Ø§Ù…Ù„Ø§Ù‹ Ù†Ø§Ø´Ù†Ø§Ø³ Ùˆ Ø§Ù…Ù† â€¢ ØªÙ…Ø§Ù… Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§ Ø¯Ø± Ù…Ø±ÙˆØ±Ú¯Ø± Ø´Ù…Ø§ Ø°Ø®ÛŒØ±Ù‡ Ù…ÛŒâ€ŒØ´ÙˆØ¯ â€¢ Ø¨Ø¯ÙˆÙ† Ù†ÛŒØ§Ø² Ø¨Ù‡ Ø³Ø±ÙˆØ± Ø®Ø§Ø±Ø¬ÛŒ</p>
            
            <!-- Ù¾Ù†Ù„ Ú©Ø§Ø±Ø¨Ø±Ø§Ù† Ø¢Ù†Ù„Ø§ÛŒÙ† -->
            <div class="online-users-panel" id="onlineUsersPanel" style="display: none;">
                <div class="online-users-title">
                    <span>ğŸ‘¥ Ú©Ø§Ø±Ø¨Ø±Ø§Ù† Ø¢Ù†Ù„Ø§ÛŒÙ†</span>
                    <span class="status-indicator"></span>
                </div>
                <div class="online-users-list" id="onlineUsersList">
                    <!-- Ú©Ø§Ø±Ø¨Ø±Ø§Ù† Ø¢Ù†Ù„Ø§ÛŒÙ† Ø§ÛŒÙ†Ø¬Ø§ Ù†Ù…Ø§ÛŒØ´ Ø¯Ø§Ø¯Ù‡ Ù…ÛŒâ€ŒØ´ÙˆÙ†Ø¯ -->
                </div>
            </div>
            
            <!-- ØªØ¨â€ŒÙ‡Ø§ÛŒ ÙˆØ±ÙˆØ¯ Ùˆ Ø«Ø¨Øªâ€ŒÙ†Ø§Ù… -->
            <div class="tabs">
                <div class="tab active" data-tab="login">ÙˆØ±ÙˆØ¯ Ø¨Ù‡ Ø­Ø³Ø§Ø¨</div>
                <div class="tab" data-tab="register">Ø§ÛŒØ¬Ø§Ø¯ Ø­Ø³Ø§Ø¨ Ø¬Ø¯ÛŒØ¯</div>
            </div>
            
            <!-- ÙØ±Ù… ÙˆØ±ÙˆØ¯ -->
            <div id="loginForm" class="form-container active">
                <div class="form-group">
                    <label for="loginUsername">Ù†Ø§Ù… Ú©Ø§Ø±Ø¨Ø±ÛŒ</label>
                    <input type="text" id="loginUsername" placeholder="Ù†Ø§Ù… Ú©Ø§Ø±Ø¨Ø±ÛŒ Ø®ÙˆØ¯ Ø±Ø§ ÙˆØ§Ø±Ø¯ Ú©Ù†ÛŒØ¯">
                </div>
                <div class="form-group">
                    <label for="loginPassword">Ø±Ù…Ø² Ø¹Ø¨ÙˆØ±</label>
                    <input type="password" id="loginPassword" placeholder="Ø±Ù…Ø² Ø¹Ø¨ÙˆØ± Ø®ÙˆØ¯ Ø±Ø§ ÙˆØ§Ø±Ø¯ Ú©Ù†ÛŒØ¯">
                </div>
                <div class="form-group" style="text-align: center; margin-top: 30px;">
                    <div style="color: #a0a0a0; margin-bottom: 10px;">Ø¯Ø³ØªØ±Ø³ÛŒ Ù…Ø¯ÛŒØ±ÛŒØª Ø³ÛŒØ³ØªÙ…</div>
                    <button class="btn btn-secondary" id="openAdminBtn" style="width: auto; padding: 12px 30px; display: inline-block;">ÙˆØ±ÙˆØ¯ Ø¨Ù‡ Ø¨Ø®Ø´ Ù…Ø¯ÛŒØ±ÛŒØª</button>
                </div>
                <button class="btn" id="loginBtn">ÙˆØ±ÙˆØ¯ Ø¨Ù‡ Ú†Øª</button>
            </div>
            
            <!-- ÙØ±Ù… Ø«Ø¨Øªâ€ŒÙ†Ø§Ù… -->
            <div id="registerForm" class="form-container">
                <div class="form-group">
                    <label for="registerUsername">Ù†Ø§Ù… Ú©Ø§Ø±Ø¨Ø±ÛŒ</label>
                    <input type="text" id="registerUsername" placeholder="ÛŒÚ© Ù†Ø§Ù… Ú©Ø§Ø±Ø¨Ø±ÛŒ Ù…Ù†Ø­ØµØ± Ø¨Ù‡ ÙØ±Ø¯ Ø§Ù†ØªØ®Ø§Ø¨ Ú©Ù†ÛŒØ¯">
                    <div style="font-size: 12px; color: #888; margin-top: 5px;">Ù†Ø§Ù… Ú©Ø§Ø±Ø¨Ø±ÛŒ Ø´Ù…Ø§ Ù‡Ø±Ú¯Ø² Ø¯Ø± Ú†Øª Ù†Ù…Ø§ÛŒØ´ Ø¯Ø§Ø¯Ù‡ Ù†Ù…ÛŒâ€ŒØ´ÙˆØ¯</div>
                </div>
                <div class="form-group">
                    <label for="registerPassword">Ø±Ù…Ø² Ø¹Ø¨ÙˆØ±</label>
                    <input type="password" id="registerPassword" placeholder="Ø±Ù…Ø² Ø¹Ø¨ÙˆØ± Ù‚ÙˆÛŒ Ø§Ù†ØªØ®Ø§Ø¨ Ú©Ù†ÛŒØ¯">
                </div>
                <div class="form-group">
                    <label for="confirmPassword">ØªÚ©Ø±Ø§Ø± Ø±Ù…Ø² Ø¹Ø¨ÙˆØ±</label>
                    <input type="password" id="confirmPassword" placeholder="Ø±Ù…Ø² Ø¹Ø¨ÙˆØ± Ø±Ø§ ØªÚ©Ø±Ø§Ø± Ú©Ù†ÛŒØ¯">
                </div>
                <div class="form-group">
                    <label for="userGender">Ø¬Ù†Ø³ÛŒØª (Ø§Ø®ØªÛŒØ§Ø±ÛŒ)</label>
                    <select id="userGender">
                        <option value="">Ø§Ù†ØªØ®Ø§Ø¨ Ù†Ú©Ù†ÛŒØ¯</option>
                        <option value="male">Ù…Ø±Ø¯</option>
                        <option value="female">Ø²Ù†</option>
                        <option value="other">Ø³Ø§ÛŒØ±</option>
                    </select>
                </div>
                <button class="btn" id="registerBtn">Ø§ÛŒØ¬Ø§Ø¯ Ø­Ø³Ø§Ø¨ Ùˆ ÙˆØ±ÙˆØ¯</button>
            </div>
            
            <!-- Ø¨Ø®Ø´ Ú†Øª (Ù¾Ø³ Ø§Ø² ÙˆØ±ÙˆØ¯ Ù†Ù…Ø§ÛŒØ´ Ø¯Ø§Ø¯Ù‡ Ù…ÛŒâ€ŒØ´ÙˆØ¯) -->
            <div id="chatSection" class="chat-container">
                <div class="user-info">
                    <div style="display: flex; align-items: center;">
                        <div class="avatar" id="userAvatar">?</div>
                        <div style="margin-right: 20px;">
                            <div style="font-weight: bold; font-size: 1.3rem;" id="displayUsername">Ø´Ù†Ø§Ø³Ù‡ Ù†Ø§Ø´Ù†Ø§Ø³</div>
                            <div style="font-size: 13px; color: #a0a0a0;" id="userStatus">Ø¢Ù†Ù„Ø§ÛŒÙ†</div>
                        </div>
                    </div>
                    <button class="logout-btn" id="logoutBtn">Ø®Ø±ÙˆØ¬ Ø§Ø² Ø­Ø³Ø§Ø¨</button>
                </div>
                
                <div class="chat-header">
                    <div>ğŸ’¬ Ú†Øª Ø¹Ù…ÙˆÙ…ÛŒ Ù†Ø§Ø´Ù†Ø§Ø³</div>
                    <div style="display: flex; align-items: center; gap: 10px;">
                        <span>Ú©Ø§Ø±Ø¨Ø±Ø§Ù† ÙØ¹Ø§Ù„:</span>
                        <span id="onlineCount">1</span>
                    </div>
                </div>
                
                <div class="chat-messages" id="chatMessages">
                    <!-- Ù¾ÛŒØ§Ù…â€ŒÙ‡Ø§ Ø¯Ø± Ø§ÛŒÙ†Ø¬Ø§ Ù†Ù…Ø§ÛŒØ´ Ø¯Ø§Ø¯Ù‡ Ù…ÛŒâ€ŒØ´ÙˆÙ†Ø¯ -->
                    <div class="message received">
                        <div class="message-sender">
                            <span class="badge">Ø³ÛŒØ³ØªÙ…</span>
                            Ø±Ø¨Ø§Øª Ù¾ÛŒØ§Ù…â€ŒØ±Ø³Ø§Ù†
                        </div>
                        <div>Ø¨Ù‡ Ú†Øª Ù†Ø§Ø´Ù†Ø§Ø³ Ø§Ù…Ù† Ø®ÙˆØ´ Ø¢Ù…Ø¯ÛŒØ¯! Ù‡Ù…Ù‡ Ù¾ÛŒØ§Ù…â€ŒÙ‡Ø§ Ø¯Ø± Ù…Ø±ÙˆØ±Ú¯Ø± Ø´Ù…Ø§ Ø°Ø®ÛŒØ±Ù‡ Ù…ÛŒâ€ŒØ´ÙˆÙ†Ø¯ Ùˆ Ù†Ø§Ø´Ù†Ø§Ø³ Ù…ÛŒâ€ŒÙ…Ø§Ù†Ù†Ø¯.</div>
                        <div class="message-info">
                            <span>Ø³ÛŒØ³ØªÙ…</span>
                            <span class="message-time">Ù‡Ù… Ø§Ú©Ù†ÙˆÙ†</span>
                        </div>
                    </div>
                </div>
                
                <div id="typingIndicator" class="typing-indicator" style="display: none;">
                    <div class="typing-dots">
                        <div class="typing-dot"></div>
                        <div class="typing-dot"></div>
                        <div class="typing-dot"></div>
                    </div>
                    <span id="typingUser">Ú©Ø§Ø±Ø¨Ø± Ø¯Ø± Ø­Ø§Ù„ ØªØ§ÛŒÙ¾ Ø§Ø³Øª...</span>
                </div>
                
                <div class="chat-input">
                    <textarea id="messageInput" placeholder="Ù¾ÛŒØ§Ù… Ø®ÙˆØ¯ Ø±Ø§ Ø¨Ù†ÙˆÛŒØ³ÛŒØ¯... (Enter Ø¨Ø±Ø§ÛŒ Ø§Ø±Ø³Ø§Ù„ØŒ Shift+Enter Ø¨Ø±Ø§ÛŒ Ø®Ø· Ø¬Ø¯ÛŒØ¯)"></textarea>
                    <button class="send-btn" id="sendMessageBtn">Ø§Ø±Ø³Ø§Ù„</button>
                </div>
            </div>
            
            <!-- Ù¾Ù†Ù„ Ù…Ø¯ÛŒØ±ÛŒØª Ø§Ø¯Ù…ÛŒÙ† -->
            <div class="admin-panel" id="adminPanel">
                <h2 style="color: #ff416c; text-align: center; margin-bottom: 30px;">ğŸ”§ Ù¾Ù†Ù„ Ù…Ø¯ÛŒØ±ÛŒØª Ø³ÛŒØ³ØªÙ…</h2>
                
                <div class="admin-section">
                    <h3>ğŸ‘¥ Ù…Ø¯ÛŒØ±ÛŒØª Ú©Ø§Ø±Ø¨Ø±Ø§Ù† (ØªØ¹Ø¯Ø§Ø¯: <span id="usersCount">0</span>)</h3>
                    <div class="admin-actions">
                        <button class="btn btn-danger" id="clearInactiveUsers">Ø­Ø°Ù Ú©Ø§Ø±Ø¨Ø±Ø§Ù† ØºÛŒØ±ÙØ¹Ø§Ù„</button>
                        <button class="btn btn-danger" id="clearAllUsers">Ø­Ø°Ù ØªÙ…Ø§Ù… Ú©Ø§Ø±Ø¨Ø±Ø§Ù†</button>
                        <button class="btn btn-secondary" id="exportUsers">Ø®Ø±ÙˆØ¬ÛŒ Ú©Ø§Ø±Ø¨Ø±Ø§Ù†</button>
                    </div>
                    <div style="overflow-x: auto;">
                        <table class="admin-table">
                            <thead>
                                <tr>
                                    <th>Ù†Ø§Ù… Ú©Ø§Ø±Ø¨Ø±ÛŒ</th>
                                    <th>Ø´Ù†Ø§Ø³Ù‡ Ù†Ø§Ø´Ù†Ø§Ø³</th>
                                    <th>Ø¢Ø®Ø±ÛŒÙ† ÙØ¹Ø§Ù„ÛŒØª</th>
                                    <th>ØªØ§Ø±ÛŒØ® Ø¹Ø¶ÙˆÛŒØª</th>
                                    <th>Ø¹Ù…Ù„ÛŒØ§Øª</th>
                                </tr>
                            </thead>
                            <tbody id="adminUsersList">
                                <!-- Ù„ÛŒØ³Øª Ú©Ø§Ø±Ø¨Ø±Ø§Ù† -->
                            </tbody>
                        </table>
                    </div>
                </div>
                
                <div class="admin-section">
                    <h3>ğŸ’¬ Ù…Ø¯ÛŒØ±ÛŒØª Ù¾ÛŒØ§Ù…â€ŒÙ‡Ø§ (ØªØ¹Ø¯Ø§Ø¯: <span id="messagesCount">0</span>)</h3>
                    <div class="admin-actions">
                        <button class="btn btn-danger" id="clearOldMessages">Ø­Ø°Ù Ù¾ÛŒØ§Ù…â€ŒÙ‡Ø§ÛŒ Ù‚Ø¯ÛŒÙ…ÛŒ</button>
                        <button class="btn btn-danger" id="clearAllMessages">Ø­Ø°Ù ØªÙ…Ø§Ù… Ù¾ÛŒØ§Ù…â€ŒÙ‡Ø§</button>
                        <button class="btn btn-secondary" id="exportMessages">Ø®Ø±ÙˆØ¬ÛŒ Ù¾ÛŒØ§Ù…â€ŒÙ‡Ø§</button>
                    </div>
                    <div style="overflow-x: auto;">
                        <table class="admin-table">
                            <thead>
                                <tr>
                                    <th>ÙØ±Ø³ØªÙ†Ø¯Ù‡</th>
                                    <th>Ù¾ÛŒØ§Ù…</th>
                                    <th>Ø²Ù…Ø§Ù† Ø§Ø±Ø³Ø§Ù„</th>
                                    <th>Ø¹Ù…Ù„ÛŒØ§Øª</th>
                                </tr>
                            </thead>
                            <tbody id="adminMessagesList">
                                <!-- Ù„ÛŒØ³Øª Ù¾ÛŒØ§Ù…â€ŒÙ‡Ø§ -->
                            </tbody>
                        </table>
                    </div>
                </div>
                
                <div class="admin-section">
                    <h3>âš™ï¸ ØªÙ†Ø¸ÛŒÙ…Ø§Øª Ø³ÛŒØ³ØªÙ…</h3>
                    <div class="admin-actions">
                        <button class="btn btn-success" id="exportAllData">Ø®Ø±ÙˆØ¬ÛŒ Ú©Ø§Ù…Ù„ Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§</button>
                        <button class="btn btn-secondary" id="importData">ÙˆØ±ÙˆØ¯ Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§</button>
                        <button class="btn btn-danger" id="resetSystem">Ø¨Ø§Ø²Ù†Ø´Ø§Ù†ÛŒ Ú©Ø§Ù…Ù„ Ø³ÛŒØ³ØªÙ…</button>
                    </div>
                    <div style="margin-top: 20px; color: #a0a0a0; font-size: 14px;">
                        <p>Ø­Ø¬Ù… Ø°Ø®ÛŒØ±Ù‡â€ŒØ³Ø§Ø²ÛŒ Ø§Ø³ØªÙØ§Ø¯Ù‡ Ø´Ø¯Ù‡: <span id="storageUsed">0</span> KB</p>
                        <p>ØªØ¹Ø¯Ø§Ø¯ Ú©Ù„ Ú©Ø§Ø±Ø¨Ø±Ø§Ù† Ø«Ø¨Øªâ€ŒÙ†Ø§Ù… Ø´Ø¯Ù‡: <span id="totalUsers">0</span></p>
                        <p>ØªØ¹Ø¯Ø§Ø¯ Ú©Ù„ Ù¾ÛŒØ§Ù…â€ŒÙ‡Ø§ÛŒ Ø§Ø±Ø³Ø§Ù„ Ø´Ø¯Ù‡: <span id="totalMessages">0</span></p>
                    </div>
                </div>
                
                <button class="btn btn-secondary" id="closePanelBtn" style="width: 100%; margin-top: 20px;">Ø¨Ø³ØªÙ† Ù¾Ù†Ù„ Ù…Ø¯ÛŒØ±ÛŒØª</button>
            </div>
        </div>
        
        <div style="text-align: center; color: #666; margin-top: 30px; font-size: 14px; line-height: 1.6;">
            <p>ğŸ”’ Ø§ÛŒÙ† Ø¨Ø±Ù†Ø§Ù…Ù‡ Ú©Ø§Ù…Ù„Ø§Ù‹ Ø¯Ø± Ù…Ø±ÙˆØ±Ú¯Ø± Ø´Ù…Ø§ Ø§Ø¬Ø±Ø§ Ù…ÛŒâ€ŒØ´ÙˆØ¯ â€¢ Ù‡ÛŒÚ† Ø¯Ø§Ø¯Ù‡â€ŒØ§ÛŒ Ø¨Ù‡ Ø³Ø±ÙˆØ± Ø§Ø±Ø³Ø§Ù„ Ù†Ù…ÛŒâ€ŒØ´ÙˆØ¯ â€¢ Ø­Ø±ÛŒÙ… Ø®ØµÙˆØµÛŒ Ø´Ù…Ø§ Ù…Ø­ÙÙˆØ¸ Ø§Ø³Øª</p>
            <p style="margin-top: 10px; color: #888;">Ø¨Ø±Ø§ÛŒ Ø¯Ø³ØªØ±Ø³ÛŒ Ø¨Ù‡ Ø¨Ø®Ø´ Ù…Ø¯ÛŒØ±ÛŒØªØŒ Ø§Ø² Ø¯Ú©Ù…Ù‡ "ÙˆØ±ÙˆØ¯ Ø¨Ù‡ Ø¨Ø®Ø´ Ù…Ø¯ÛŒØ±ÛŒØª" Ø§Ø³ØªÙØ§Ø¯Ù‡ Ú©Ù†ÛŒØ¯</p>
        </div>
    </div>
    
    <!-- Ø§Ø¹Ù„Ø§Ù†â€ŒÙ‡Ø§ -->
    <div id="notification" class="notification"></div>

    <script>
        // Ø³ÛŒØ³ØªÙ… Ú†Øª Ù†Ø§Ø´Ù†Ø§Ø³ Ù¾ÛŒØ´Ø±ÙØªÙ‡
        class SecureAnonymousChat {
            constructor() {
                this.storage = new EnhancedStorage();
                this.currentUser = null;
                this.typingUsers = new Set();
                this.onlineUsers = new Map();
                this.typingTimeout = null;
                this.init();
            }
            
            init() {
                this.setupEventListeners();
                this.checkAutoLogin();
                this.loadMessages();
                this.startOnlineCheck();
                
                // ØªÙ†Ø¸ÛŒÙ… ØªØ§ÛŒÙ…Ø± Ø¨Ø±Ø§ÛŒ Ø¨Ø±ÙˆØ²Ø±Ø³Ø§Ù†ÛŒ Ø¢Ù†Ù„Ø§ÛŒÙ†
                setInterval(() => this.updateOnlineStatus(), 30000);
                setInterval(() => this.updateOnlineUsersDisplay(), 5000);
            }
            
            setupEventListeners() {
                // ØªØ¨â€ŒÙ‡Ø§
                document.querySelectorAll('.tab').forEach(tab => {
                    tab.addEventListener('click', () => {
                        const tabId = tab.getAttribute('data-tab');
                        this.switchTab(tabId);
                    });
                });
                
                // ÙˆØ±ÙˆØ¯ Ùˆ Ø«Ø¨Øªâ€ŒÙ†Ø§Ù…
                document.getElementById('loginBtn').addEventListener('click', () => this.login());
                document.getElementById('registerBtn').addEventListener('click', () => this.register());
                
                // Ù…Ø¯ÛŒØ±ÛŒØª Ù¾ÛŒØ§Ù…â€ŒÙ‡Ø§
                document.getElementById('sendMessageBtn').addEventListener('click', () => this.sendMessage());
                const messageInput = document.getElementById('messageInput');
                messageInput.addEventListener('keydown', (e) => {
                    if (e.key === 'Enter' && !e.shiftKey) {
                        e.preventDefault();
                        this.sendMessage();
                    }
                });
                
                // ØªØ§ÛŒÙ¾ Ú©Ø±Ø¯Ù†
                messageInput.addEventListener('input', () => {
                    if (this.currentUser) {
                        this.setTypingStatus(true);
                        clearTimeout(this.typingTimeout);
                        this.typingTimeout = setTimeout(() => {
                            this.setTypingStatus(false);
                        }, 2000);
                    }
                });
                
                // Ø®Ø±ÙˆØ¬
                document.getElementById('logoutBtn').addEventListener('click', () => this.logout());
                
                // Ø¯Ø³ØªØ±Ø³ÛŒ Ø§Ø¯Ù…ÛŒÙ†
                document.getElementById('openAdminBtn').addEventListener('click', () => this.openAdminAccess());
                document.getElementById('closeAdminBtn').addEventListener('click', () => this.closeAdminAccess());
                document.getElementById('adminLoginBtn').addEventListener('click', () => this.adminLogin());
                document.getElementById('adminBadge').addEventListener('click', () => this.toggleAdminPanel());
                document.getElementById('closePanelBtn').addEventListener('click', () => this.toggleAdminPanel());
                
                // Ù…Ø¯ÛŒØ±ÛŒØª Ø§Ø¯Ù…ÛŒÙ†
                document.getElementById('clearAllUsers').addEventListener('click', () => this.adminClearAllUsers());
                document.getElementById('clearAllMessages').addEventListener('click', () => this.adminClearAllMessages());
                document.getElementById('clearInactiveUsers').addEventListener('click', () => this.adminClearInactiveUsers());
                document.getElementById('clearOldMessages').addEventListener('click', () => this.adminClearOldMessages());
                document.getElementById('exportUsers').addEventListener('click', () => this.adminExportUsers());
                document.getElementById('exportMessages').addEventListener('click', () => this.adminExportMessages());
                document.getElementById('exportAllData').addEventListener('click', () => this.adminExportAllData());
                document.getElementById('importData').addEventListener('click', () => this.adminImportData());
                document.getElementById('resetSystem').addEventListener('click', () => this.adminResetSystem());
                
                // Ø±ÙØ¹ Ù…Ø´Ú©Ù„ overlay
                document.getElementById('adminOverlay').addEventListener('click', () => this.closeAdminAccess());
            }
            
            switchTab(tabId) {
                document.querySelectorAll('.tab').forEach(tab => {
                    tab.classList.toggle('active', tab.getAttribute('data-tab') === tabId);
                });
                
                document.querySelectorAll('.form-container').forEach(form => {
                    form.classList.toggle('active', form.id === `${tabId}Form`);
                });
            }
            
            showNotification(message, type = 'success', duration = 3000) {
                const notification = document.getElementById('notification');
                notification.textContent = message;
                
                const colors = {
                    success: 'linear-gradient(135deg, #00b09b, #96c93d)',
                    error: 'linear-gradient(135deg, #ff416c, #ff4b2b)',
                    warning: 'linear-gradient(135deg, #f7971e, #ffd200)',
                    info: 'linear-gradient(135deg, #0099ff, #00ccff)'
                };
                
                notification.style.background = colors[type] || colors.info;
                notification.classList.add('show');
                
                setTimeout(() => {
                    notification.classList.remove('show');
                }, duration);
            }
            
            generateAnonymousId(username, gender = '') {
                const adjectives = ['Ù…Ø¨Ù‡Ù…', 'Ù†Ø§Ø´Ù†Ø§Ø³', 'Ù…Ø±Ù…ÙˆØ²', 'Ø³Ø§Ú©Øª', 'Ø®Ø§Ù…ÙˆØ´', 'Ù¾Ù†Ù‡Ø§Ù†', 'Ù…Ø®ÙÛŒ', 'Ø±Ø§Ø²Ø¢Ù„ÙˆØ¯'];
                const nouns = ['Ø³Ø§ÛŒÙ‡', 'Ø´Ø¨Ø­', 'Ø±Ø§Ø²', 'ØµØ¯Ø§', 'Ù†ÙØ±', 'Ø´Ø®Øµ', 'Ù‡Ù… ØµØ­Ø¨Øª', 'Ù†Ø§Ø¸Ø±'];
                const genderPrefixes = {
                    male: ['Ø¢Ù‚Ø§ÛŒ', 'Ù…Ø±Ø¯', 'Ø¢Ù‚Ø§'],
                    female: ['Ø®Ø§Ù†Ù…', 'Ø²Ù†', 'Ø¨Ø§Ù†Ùˆ'],
                    other: ['ÙØ±Ø¯', 'Ø´Ø®Øµ', 'Ù‡Ù…Ø±Ø§Ù‡']
                };
                
                let prefix = '';
                if (gender && genderPrefixes[gender]) {
                    prefix = genderPrefixes[gender][Math.floor(Math.random() * genderPrefixes[gender].length)] + ' ';
                }
                
                const adj = adjectives[Math.floor(Math.random() * adjectives.length)];
                const noun = nouns[Math.floor(Math.random() * nouns.length)];
                const num = Math.floor(Math.random() * 999) + 1;
                
                return `${prefix}${adj} ${noun} ${num}`;
            }
            
            register() {
                const username = document.getElementById('registerUsername').value.trim();
                const password = document.getElementById('registerPassword').value;
                const confirmPassword = document.getElementById('confirmPassword').value;
                const gender = document.getElementById('userGender').value;
                
                if (!username || !password) {
                    this.showNotification('Ù„Ø·ÙØ§Ù‹ Ù†Ø§Ù… Ú©Ø§Ø±Ø¨Ø±ÛŒ Ùˆ Ø±Ù…Ø² Ø¹Ø¨ÙˆØ± Ø±Ø§ ÙˆØ§Ø±Ø¯ Ú©Ù†ÛŒØ¯', 'error');
                    return;
                }
                
                if (password.length < 6) {
                    this.showNotification('Ø±Ù…Ø² Ø¹Ø¨ÙˆØ± Ø¨Ø§ÛŒØ¯ Ø­Ø¯Ø§Ù‚Ù„ Û¶ Ú©Ø§Ø±Ø§Ú©ØªØ± Ø¨Ø§Ø´Ø¯', 'error');
                    return;
                }
                
                if (password !== confirmPassword) {
                    this.showNotification('Ø±Ù…Ø² Ø¹Ø¨ÙˆØ± Ùˆ ØªÚ©Ø±Ø§Ø± Ø¢Ù† Ù…Ø·Ø§Ø¨Ù‚Øª Ù†Ø¯Ø§Ø±Ù†Ø¯', 'error');
                    return;
                }
                
                if (username.length < 3) {
                    this.showNotification('Ù†Ø§Ù… Ú©Ø§Ø±Ø¨Ø±ÛŒ Ø¨Ø§ÛŒØ¯ Ø­Ø¯Ø§Ù‚Ù„ Û³ Ú©Ø§Ø±Ø§Ú©ØªØ± Ø¨Ø§Ø´Ø¯', 'error');
                    return;
                }
                
                // Ø¨Ø±Ø±Ø³ÛŒ ÙˆØ¬ÙˆØ¯ Ú©Ø§Ø±Ø¨Ø±
                const users = this.storage.getUsers();
                const existingUser = users.find(user => user.username === username);
                
                if (existingUser) {
                    this.showNotification('Ø§ÛŒÙ† Ù†Ø§Ù… Ú©Ø§Ø±Ø¨Ø±ÛŒ Ù‚Ø¨Ù„Ø§Ù‹ Ø«Ø¨Øª Ø´Ø¯Ù‡ Ø§Ø³Øª', 'error');
                    return;
                }
                
                // Ø§ÛŒØ¬Ø§Ø¯ Ú©Ø§Ø±Ø¨Ø± Ø¬Ø¯ÛŒØ¯
                const anonymousId = this.generateAnonymousId(username, gender);
                const newUser = {
                    id: 'user_' + Date.now(),
                    username,
                    password: this.hashPassword(password),
                    anonymousId,
                    gender,
                    registeredAt: new Date().toISOString(),
                    lastSeen: new Date().toISOString(),
                    lastActive: new Date().toISOString(),
                    isOnline: true,
                    messageCount: 0
                };
                
                // Ø°Ø®ÛŒØ±Ù‡ Ú©Ø§Ø±Ø¨Ø±
                this.storage.saveUser(newUser);
                this.showNotification(`Ø­Ø³Ø§Ø¨ Ø´Ù…Ø§ Ø¨Ø§ Ø´Ù†Ø§Ø³Ù‡ "${anonymousId}" Ø§ÛŒØ¬Ø§Ø¯ Ø´Ø¯`);
                
                // ÙˆØ±ÙˆØ¯ Ø®ÙˆØ¯Ú©Ø§Ø±
                setTimeout(() => {
                    this.loginUser(newUser);
                }, 1500);
            }
            
            hashPassword(password) {
                // Ø¯Ø± ÛŒÚ© Ø¨Ø±Ù†Ø§Ù…Ù‡ ÙˆØ§Ù‚Ø¹ÛŒ Ø¨Ø§ÛŒØ¯ Ø§Ø² Ø§Ù„Ú¯ÙˆØ±ÛŒØªÙ… Ù…Ù†Ø§Ø³Ø¨ Ø§Ø³ØªÙØ§Ø¯Ù‡ Ø´ÙˆØ¯
                // Ø§ÛŒÙ† ÙÙ‚Ø· Ø¨Ø±Ø§ÛŒ Ù†Ù…ÙˆÙ†Ù‡ Ø§Ø³Øª
                let hash = 0;
                for (let i = 0; i < password.length; i++) {
                    const char = password.charCodeAt(i);
                    hash = ((hash << 5) - hash) + char;
                    hash = hash & hash;
                }
                return hash.toString();
            }
            
            login() {
                const username = document.getElementById('loginUsername').value.trim();
                const password = document.getElementById('loginPassword').value;
                
                if (!username || !password) {
                    this.showNotification('Ù„Ø·ÙØ§Ù‹ Ù†Ø§Ù… Ú©Ø§Ø±Ø¨Ø±ÛŒ Ùˆ Ø±Ù…Ø² Ø¹Ø¨ÙˆØ± Ø±Ø§ ÙˆØ§Ø±Ø¯ Ú©Ù†ÛŒØ¯', 'error');
                    return;
                }
                
                const users = this.storage.getUsers();
                const user = users.find(u => u.username === username && u.password === this.hashPassword(password));
                
                if (user) {
                    this.loginUser(user);
                } else {
                    this.showNotification('Ù†Ø§Ù… Ú©Ø§Ø±Ø¨Ø±ÛŒ ÛŒØ§ Ø±Ù…Ø² Ø¹Ø¨ÙˆØ± Ù†Ø§Ø¯Ø±Ø³Øª Ø§Ø³Øª', 'error');
                }
            }
            
            loginUser(user) {
                this.currentUser = user;
                this.currentUser.lastSeen = new Date().toISOString();
                this.currentUser.lastActive = new Date().toISOString();
                this.currentUser.isOnline = true;
                
                this.storage.updateUser(user);
                this.storage.setCurrentUser(user);
                
                // Ù†Ù…Ø§ÛŒØ´ Ø¨Ø®Ø´ Ú†Øª
                document.getElementById('loginForm').classList.remove('active');
                document.getElementById('registerForm').classList.remove('active');
                document.getElementById('chatSection').style.display = 'flex';
                document.getElementById('onlineUsersPanel').style.display = 'block';
                
                // Ø¨Ù‡ Ø±ÙˆØ²Ø±Ø³Ø§Ù†ÛŒ Ø§Ø·Ù„Ø§Ø¹Ø§Øª Ú©Ø§Ø±Ø¨Ø±
                document.getElementById('displayUsername').textContent = user.anonymousId;
                document.getElementById('userAvatar').textContent = user.anonymousId.charAt(0);
                document.getElementById('userAvatar').style.background = this.getAvatarColor(user.username);
                
                // Ù¾Ø§Ú© Ú©Ø±Ø¯Ù† ÙÛŒÙ„Ø¯Ù‡Ø§
                ['loginUsername', 'loginPassword', 'registerUsername', 'registerPassword', 'confirmPassword'].forEach(id => {
                    document.getElementById(id).value = '';
                });
                
                // Ø¨Ù‡ Ø±ÙˆØ²Ø±Ø³Ø§Ù†ÛŒ ÙˆØ¶Ø¹ÛŒØª Ø¢Ù†Ù„Ø§ÛŒÙ†
                this.updateOnlineStatus();
                this.updateOnlineUsersDisplay();
                
                this.showNotification(`Ø®ÙˆØ´ Ø¢Ù…Ø¯ÛŒØ¯ ${user.anonymousId}!`);
                
                // Ø¨Ø±Ø±Ø³ÛŒ Ø§Ú¯Ø± Ú©Ø§Ø±Ø¨Ø± Ø§Ø¯Ù…ÛŒÙ† Ø§Ø³Øª
                if (user.username === 'admin') {
                    document.getElementById('adminBadge').style.display = 'block';
                }
            }
            
            getAvatarColor(username) {
                const colors = [
                    'linear-gradient(135deg, #ff416c, #ff4b2b)',
                    'linear-gradient(135deg, #0099ff, #00ccff)',
                    'linear-gradient(135deg, #00b09b, #96c93d)',
                    'linear-gradient(135deg, #f7971e, #ffd200)',
                    'linear-gradient(135deg, #834d9b, #d04ed6)',
                    'linear-gradient(135deg, #1d976c, #93f9b9)'
                ];
                
                let hash = 0;
                for (let i = 0; i < username.length; i++) {
                    hash = username.charCodeAt(i) + ((hash << 5) - hash);
                }
                
                return colors[Math.abs(hash) % colors.length];
            }
            
            checkAutoLogin() {
                const user = this.storage.getCurrentUser();
                if (user) {
                    const users = this.storage.getUsers();
                    const foundUser = users.find(u => u.id === user.id && u.password === user.password);
                    if (foundUser) {
                        this.loginUser(foundUser);
                    } else {
                        this.storage.clearCurrentUser();
                    }
                }
            }
            
            sendMessage() {
                if (!this.currentUser) {
                    this.showNotification('Ù„Ø·ÙØ§Ù‹ Ø§Ø¨ØªØ¯Ø§ ÙˆØ§Ø±Ø¯ Ø´ÙˆÛŒØ¯', 'error');
                    return;
                }
                
                const messageInput = document.getElementById('messageInput');
                const messageText = messageInput.value.trim();
                
                if (!messageText) {
                    this.showNotification('Ù„Ø·ÙØ§Ù‹ Ù…ØªÙ†ÛŒ Ø¨Ø±Ø§ÛŒ Ø§Ø±Ø³Ø§Ù„ ÙˆØ§Ø±Ø¯ Ú©Ù†ÛŒØ¯', 'error');
                    return;
                }
                
                // Ø§ÛŒØ¬Ø§Ø¯ Ù¾ÛŒØ§Ù… Ø¬Ø¯ÛŒØ¯
                const message = {
                    id: 'msg_' + Date.now() + '_' + Math.random().toString(36).substr(2, 9),
                    senderId: this.currentUser.anonymousId,
                    senderUsername: this.currentUser.username,
                    text: messageText,
                    timestamp: new Date().toISOString(),
                    timeDisplay: new Date().toLocaleTimeString('fa-IR', { 
                        hour: '2-digit', 
                        minute: '2-digit'
                    }),
                    dateDisplay: new Date().toLocaleDateString('fa-IR')
                };
                
                // Ø°Ø®ÛŒØ±Ù‡ Ù¾ÛŒØ§Ù…
                this.storage.saveMessage(message);
                
                // Ø¨Ù‡ Ø±ÙˆØ²Ø±Ø³Ø§Ù†ÛŒ ØªØ¹Ø¯Ø§Ø¯ Ù¾ÛŒØ§Ù…â€ŒÙ‡Ø§ÛŒ Ú©Ø§Ø±Ø¨Ø±
                this.currentUser.messageCount = (this.currentUser.messageCount || 0) + 1;
                this.currentUser.lastActive = new Date().toISOString();
                this.storage.updateUser(this.currentUser);
                
                // Ù†Ù…Ø§ÛŒØ´ Ù¾ÛŒØ§Ù…
                this.displayMessage(message, true);
                
                // Ù¾Ø§Ú© Ú©Ø±Ø¯Ù† ÙÛŒÙ„Ø¯ ÙˆØ±ÙˆØ¯ÛŒ
                messageInput.value = '';
                messageInput.focus();
                
                // Ø§Ø³Ú©Ø±ÙˆÙ„ Ø¨Ù‡ Ù¾Ø§ÛŒÛŒÙ†
                setTimeout(() => {
                    const chatMessages = document.getElementById('chatMessages');
                    chatMessages.scrollTop = chatMessages.scrollHeight;
                }, 100);
                
                // Ù¾Ù†Ù‡Ø§Ù† Ú©Ø±Ø¯Ù† ÙˆØ¶Ø¹ÛŒØª ØªØ§ÛŒÙ¾
                this.setTypingStatus(false);
                
                // Ø¨Ù‡ Ø±ÙˆØ²Ø±Ø³Ø§Ù†ÛŒ Ù¾Ù†Ù„ Ø§Ø¯Ù…ÛŒÙ† Ø§Ú¯Ø± Ø¨Ø§Ø² Ø§Ø³Øª
                this.updateAdminPanel();
            }
            
            displayMessage(message, isSentByMe = false) {
                const chatMessages = document.getElementById('chatMessages');
                
                const messageDiv = document.createElement('div');
                messageDiv.className = `message ${isSentByMe ? 'sent' : 'received'}`;
                
                const senderDisplay = isSentByMe ? 'Ø´Ù…Ø§' : message.senderId;
                
                messageDiv.innerHTML = `
                    <div class="message-sender">
                        ${!isSentByMe ? `<span class="badge">${message.senderId.split(' ')[0]}</span>` : ''}
                        ${senderDisplay}
                    </div>
                    <div>${this.escapeHtml(message.text)}</div>
                    <div class="message-info">
                        <span>${isSentByMe ? 'Ø´Ù…Ø§' : message.senderId}</span>
                        <span class="message-time">${message.timeDisplay}</span>
                    </div>
                `;
                
                chatMessages.appendChild(messageDiv);
            }
            
            escapeHtml(text) {
                const div = document.createElement('div');
                div.textContent = text;
                return div.innerHTML;
            }
            
            loadMessages() {
                const messages = this.storage.getMessages();
                const chatMessages = document.getElementById('chatMessages');
                
                // Ù¾Ø§Ú© Ú©Ø±Ø¯Ù† Ù¾ÛŒØ§Ù…â€ŒÙ‡Ø§ÛŒ ÙØ¹Ù„ÛŒ (Ø¨Ù‡ Ø¬Ø² Ù¾ÛŒØ§Ù… Ø®ÙˆØ´â€ŒØ¢Ù…Ø¯Ú¯ÙˆÛŒÛŒ)
                const welcomeMessage = chatMessages.querySelector('.message.received');
                chatMessages.innerHTML = '';
                if (welcomeMessage) {
                    chatMessages.appendChild(welcomeMessage);
                }
                
                // Ù†Ù…Ø§ÛŒØ´ Ù¾ÛŒØ§Ù…â€ŒÙ‡Ø§
                let lastDate = null;
                messages.forEach(message => {
                    const messageDate = new Date(message.timestamp).toLocaleDateString('fa-IR');
                    
                    // Ø§ÙØ²ÙˆØ¯Ù† ØªØ§Ø±ÛŒØ® Ø§Ú¯Ø± ØªØºÛŒÛŒØ± Ú©Ø±Ø¯Ù‡ Ø¨Ø§Ø´Ø¯
                    if (messageDate !== lastDate) {
                        const dateDiv = document.createElement('div');
                        dateDiv.style.textAlign = 'center';
                        dateDiv.style.margin = '20px 0';
                        dateDiv.style.color = '#888';
                        dateDiv.style.fontSize = '14px';
                        dateDiv.innerHTML = `<hr style="border-color: #333; margin: 10px;">${messageDate}<hr style="border-color: #333; margin: 10px;">`;
                        chatMessages.appendChild(dateDiv);
                        lastDate = messageDate;
                    }
                    
                    const isSentByMe = this.currentUser && 
                                      (message.senderUsername === this.currentUser.username);
                    this.displayMessage(message, isSentByMe);
                });
                
                // Ø§Ø³Ú©Ø±ÙˆÙ„ Ø¨Ù‡ Ù¾Ø§ÛŒÛŒÙ†
                setTimeout(() => {
                    chatMessages.scrollTop = chatMessages.scrollHeight;
                }, 100);
            }
            
            setTypingStatus(isTyping) {
                if (!this.currentUser) return;
                
                if (isTyping) {
                    this.typingUsers.add(this.currentUser.anonymousId);
                    this.currentUser.lastActive = new Date().toISOString();
                    this.storage.updateUser(this.currentUser);
                } else {
                    this.typingUsers.delete(this.currentUser.anonymousId);
                }
                
                this.updateTypingIndicator();
            }
            
            updateTypingIndicator() {
                const typingIndicator = document.getElementById('typingIndicator');
                const typingUser = document.getElementById('typingUser');
                
                if (this.typingUsers.size > 0) {
                    const typers = Array.from(this.typingUsers);
                    if (typers.length === 1) {
                        typingUser.textContent = `${typers[0]} Ø¯Ø± Ø­Ø§Ù„ ØªØ§ÛŒÙ¾ Ø§Ø³Øª...`;
                    } else if (typers.length === 2) {
                        typingUser.textContent = `${typers[0]} Ùˆ ${typers[1]} Ø¯Ø± Ø­Ø§Ù„ ØªØ§ÛŒÙ¾ Ù‡Ø³ØªÙ†Ø¯...`;
                    } else {
                        typingUser.textContent = `${typers.length} Ú©Ø§Ø±Ø¨Ø± Ø¯Ø± Ø­Ø§Ù„ ØªØ§ÛŒÙ¾ Ù‡Ø³ØªÙ†Ø¯...`;
                    }
                    typingIndicator.style.display = 'flex';
                } else {
                    typingIndicator.style.display = 'none';
                }
            }
            
            updateOnlineStatus() {
                if (!this.currentUser) return;
                
                this.currentUser.lastSeen = new Date().toISOString();
                this.storage.updateUser(this.currentUser);
                this.updateOnlineUsersDisplay();
            }
            
            startOnlineCheck() {
                setInterval(() => {
                    const users = this.storage.getUsers();
                    const now = new Date();
                    
                    users.forEach(user => {
                        const lastSeen = new Date(user.lastSeen);
                        const diffMinutes = (now - lastSeen) / (1000 * 60);
                        user.isOnline = diffMinutes < 5; // 5 Ø¯Ù‚ÛŒÙ‚Ù‡ Ø¢Ù†Ù„Ø§ÛŒÙ† Ø¯Ø± Ù†Ø¸Ø± Ú¯Ø±ÙØªÙ‡ Ù…ÛŒâ€ŒØ´ÙˆØ¯
                        this.storage.updateUser(user);
                    });
                    
                    this.updateOnlineUsersDisplay();
                }, 60000); // Ù‡Ø± Ø¯Ù‚ÛŒÙ‚Ù‡ Ø¨Ø±Ø±Ø³ÛŒ Ú©Ù†
            }
            
            updateOnlineUsersDisplay() {
                const users = this.storage.getUsers();
                const now = new Date();
                
                // ÙÛŒÙ„ØªØ± Ú©Ø§Ø±Ø¨Ø±Ø§Ù† Ø¢Ù†Ù„Ø§ÛŒÙ† (ÙØ¹Ø§Ù„ Ø¯Ø± 5 Ø¯Ù‚ÛŒÙ‚Ù‡ Ú¯Ø°Ø´ØªÙ‡)
                const onlineUsers = users.filter(user => {
                    if (user.username === 'admin') return false; // Ø§Ø¯Ù…ÛŒÙ† Ø±Ø§ Ù†Ù…Ø§ÛŒØ´ Ù†Ø¯Ù‡
                    const lastSeen = new Date(user.lastSeen);
                    const diffMinutes = (now - lastSeen) / (1000 * 60);
                    return diffMinutes < 5;
                });
                
                // Ø¨Ù‡ Ø±ÙˆØ²Ø±Ø³Ø§Ù†ÛŒ ØªØ¹Ø¯Ø§Ø¯
                document.getElementById('onlineCount').textContent = onlineUsers.length;
                
                // Ø¨Ù‡ Ø±ÙˆØ²Ø±Ø³Ø§Ù†ÛŒ Ù„ÛŒØ³Øª
                const onlineUsersList = document.getElementById('onlineUsersList');
                onlineUsersList.innerHTML = '';
                
                onlineUsers.forEach(user => {
                    const userDiv = document.createElement('div');
                    userDiv.className = 'online-user';
                    
                    userDiv.innerHTML = `
                        <div class="online-user-avatar" style="background: ${this.getAvatarColor(user.username)}">
                            ${user.anonymousId.charAt(0)}
                        </div>
                        <div>
                            <div style="font-weight: bold;">${user.anonymousId}</div>
                            <div style="font-size: 11px; color: #aaa;">
                                ${new Date(user.lastSeen).toLocaleTimeString('fa-IR', {hour: '2-digit', minute: '2-digit'})}
                            </div>
                        </div>
                        <div class="status-indicator"></div>
                    `;
                    
                    onlineUsersList.appendChild(userDiv);
                });
            }
            
            logout() {
                if (this.currentUser) {
                    this.currentUser.isOnline = false;
                    this.storage.updateUser(this.currentUser);
                }
                
                this.currentUser = null;
                this.storage.clearCurrentUser();
                
                // Ø¨Ø§Ø²Ú¯Ø´Øª Ø¨Ù‡ ØµÙØ­Ù‡ ÙˆØ±ÙˆØ¯
                document.getElementById('chatSection').style.display = 'none';
                document.getElementById('onlineUsersPanel').style.display = 'none';
                document.getElementById('adminPanel').classList.remove('show');
                document.getElementById('adminBadge').style.display = 'none';
                document.getElementById('loginForm').classList.add('active');
                this.switchTab('login');
                
                this.showNotification('Ø¨Ø§ Ù…ÙˆÙÙ‚ÛŒØª Ø®Ø§Ø±Ø¬ Ø´Ø¯ÛŒØ¯');
            }
            
            // Ø¨Ø®Ø´ Ù…Ø¯ÛŒØ±ÛŒØª Ø§Ø¯Ù…ÛŒÙ†
            openAdminAccess() {
                document.getElementById('adminOverlay').classList.add('show');
                document.getElementById('adminAccess').classList.add('show');
            }
            
            closeAdminAccess() {
                document.getElementById('adminOverlay').classList.remove('show');
                document.getElementById('adminAccess').classList.remove('show');
            }
            
            adminLogin() {
                const username = document.getElementById('adminUsername').value.trim();
                const password = document.getElementById('adminPassword').value;
                const secret = document.getElementById('adminSecret').value;
                
                // Ø§Ø¹ØªØ¨Ø§Ø±Ø³Ù†Ø¬ÛŒ Ø§Ø¯Ù…ÛŒÙ†
                const adminData = this.storage.getAdminData();
                
                if (username === adminData.username && 
                    password === adminData.password && 
                    secret === adminData.secret) {
                    
                    this.closeAdminAccess();
                    this.showNotification('ÙˆØ±ÙˆØ¯ Ø¨Ù‡ Ù¾Ù†Ù„ Ù…Ø¯ÛŒØ±ÛŒØª Ù…ÙˆÙÙ‚ Ø¨ÙˆØ¯', 'success');
                    
                    // Ù†Ù…Ø§ÛŒØ´ Ù†Ø´Ø§Ù†Ú¯Ø± Ø§Ø¯Ù…ÛŒÙ†
                    document.getElementById('adminBadge').style.display = 'block';
                    
                    // Ø§Ú¯Ø± Ú©Ø§Ø±Ø¨Ø± ÙˆØ§Ø±Ø¯ Ø´Ø¯Ù‡ØŒ Ù¾Ù†Ù„ Ø±Ø§ Ù†Ù…Ø§ÛŒØ´ Ø¨Ø¯Ù‡
                    if (this.currentUser) {
                        this.toggleAdminPanel();
                    }
                    
                    // Ù¾Ø§Ú© Ú©Ø±Ø¯Ù† ÙÛŒÙ„Ø¯Ù‡Ø§
                    document.getElementById('adminUsername').value = '';
                    document.getElementById('adminPassword').value = '';
                    document.getElementById('adminSecret').value = '';
                    
                } else {
                    this.showNotification('Ø§Ø¹ØªØ¨Ø§Ø±Ø³Ù†Ø¬ÛŒ Ù†Ø§Ù…ÙˆÙÙ‚ Ø¨ÙˆØ¯', 'error');
                }
            }
            
            toggleAdminPanel() {
                const panel = document.getElementById('adminPanel');
                panel.classList.toggle('show');
                
                if (panel.classList.contains('show')) {
                    this.updateAdminPanel();
                }
            }
            
            updateAdminPanel() {
                const users = this.storage.getUsers();
                const messages = this.storage.getMessages();
                
                // Ø¨Ù‡ Ø±ÙˆØ²Ø±Ø³Ø§Ù†ÛŒ Ø¢Ù…Ø§Ø±
                document.getElementById('usersCount').textContent = users.length;
                document.getElementById('messagesCount').textContent = messages.length;
                document.getElementById('totalUsers').textContent = users.length;
                document.getElementById('totalMessages').textContent = messages.length;
                
                // Ù…Ø­Ø§Ø³Ø¨Ù‡ Ø­Ø¬Ù… Ø°Ø®ÛŒØ±Ù‡â€ŒØ³Ø§Ø²ÛŒ
                const storageUsed = Math.round((JSON.stringify(localStorage).length / 1024) * 100) / 100;
                document.getElementById('storageUsed').textContent = storageUsed;
                
                // Ø¨Ù‡ Ø±ÙˆØ²Ø±Ø³Ø§Ù†ÛŒ Ù„ÛŒØ³Øª Ú©Ø§Ø±Ø¨Ø±Ø§Ù†
                const usersList = document.getElementById('adminUsersList');
                usersList.innerHTML = '';
                
                users.forEach(user => {
                    if (user.username === 'admin') return; // Ø§Ø¯Ù…ÛŒÙ† Ø§ØµÙ„ÛŒ Ø±Ø§ Ù†Ù…Ø§ÛŒØ´ Ù†Ø¯Ù‡
                    
                    const row = document.createElement('tr');
                    const lastSeen = new Date(user.lastSeen);
                    const now = new Date();
                    const diffMinutes = Math.round((now - lastSeen) / (1000 * 60));
                    const isOnline = diffMinutes < 5;
                    
                    row.innerHTML = `
                        <td>${user.username}</td>
                        <td>${user.anonymousId}</td>
                        <td>
                            ${isOnline ? '<span style="color: #00ff00;">â— Ø¢Ù†Ù„Ø§ÛŒÙ†</span>' : `${diffMinutes} Ø¯Ù‚ÛŒÙ‚Ù‡ Ù¾ÛŒØ´`}
                        </td>
                        <td>${new Date(user.registeredAt).toLocaleDateString('fa-IR')}</td>
                        <td>
                            <button class="btn btn-danger" style="padding: 5px 10px; font-size: 12px;" 
                                    onclick="chat.adminDeleteUser('${user.id}')">
                                Ø­Ø°Ù
                            </button>
                        </td>
                    `;
                    
                    usersList.appendChild(row);
                });
                
                // Ø¨Ù‡ Ø±ÙˆØ²Ø±Ø³Ø§Ù†ÛŒ Ù„ÛŒØ³Øª Ù¾ÛŒØ§Ù…â€ŒÙ‡Ø§
                const messagesList = document.getElementById('adminMessagesList');
                messagesList.innerHTML = '';
                
                // ÙÙ‚Ø· 50 Ù¾ÛŒØ§Ù… Ø¢Ø®Ø± Ø±Ø§ Ù†Ù…Ø§ÛŒØ´ Ø¨Ø¯Ù‡
                const recentMessages = messages.slice(-50);
                
                recentMessages.forEach(message => {
                    const row = document.createElement('tr');
                    
                    row.innerHTML = `
                        <td>
                            <div>${message.senderId}</div>
                            <small>${message.senderUsername}</small>
                        </td>
                        <td style="max-width: 300px; overflow: hidden; text-overflow: ellipsis;">${message.text}</td>
                        <td>${new Date(message.timestamp).toLocaleString('fa-IR')}</td>
                        <td>
                            <button class="btn btn-danger" style="padding: 5px 10px; font-size: 12px;"
                                    onclick="chat.adminDeleteMessage('${message.id}')">
                                Ø­Ø°Ù
                            </button>
                        </td>
                    `;
                    
                    messagesList.appendChild(row);
                });
            }
            
            // ØªÙˆØ§Ø¨Ø¹ Ù…Ø¯ÛŒØ±ÛŒØª Ø§Ø¯Ù…ÛŒÙ†
            adminDeleteUser(userId) {
                if (confirm('Ø¢ÛŒØ§ Ø§Ø² Ø­Ø°Ù Ø§ÛŒÙ† Ú©Ø§Ø±Ø¨Ø± Ù…Ø·Ù…Ø¦Ù† Ù‡Ø³ØªÛŒØ¯ØŸ ØªÙ…Ø§Ù… Ù¾ÛŒØ§Ù…â€ŒÙ‡Ø§ÛŒ Ø§Ùˆ Ù†ÛŒØ² Ø­Ø°Ù Ø®ÙˆØ§Ù‡Ù†Ø¯ Ø´Ø¯.')) {
                    this.storage.deleteUser(userId);
                    this.updateAdminPanel();
                    this.updateOnlineUsersDisplay();
                    this.showNotification('Ú©Ø§Ø±Ø¨Ø± Ø­Ø°Ù Ø´Ø¯', 'success');
                }
            }
            
            adminDeleteMessage(messageId) {
                if (confirm('Ø¢ÛŒØ§ Ø§Ø² Ø­Ø°Ù Ø§ÛŒÙ† Ù¾ÛŒØ§Ù… Ù…Ø·Ù…Ø¦Ù† Ù‡Ø³ØªÛŒØ¯ØŸ')) {
                    this.storage.deleteMessage(messageId);
                    this.loadMessages();
                    this.updateAdminPanel();
                    this.showNotification('Ù¾ÛŒØ§Ù… Ø­Ø°Ù Ø´Ø¯', 'success');
                }
            }
            
            adminClearAllUsers() {
                if (confirm('Ø¢ÛŒØ§ Ø§Ø² Ø­Ø°Ù ØªÙ…Ø§Ù… Ú©Ø§Ø±Ø¨Ø±Ø§Ù† (Ø¨Ù‡ Ø¬Ø² Ø§Ø¯Ù…ÛŒÙ†) Ù…Ø·Ù…Ø¦Ù† Ù‡Ø³ØªÛŒØ¯ØŸ Ø§ÛŒÙ† Ø¹Ù…Ù„ ØºÛŒØ±Ù‚Ø§Ø¨Ù„ Ø¨Ø§Ø²Ú¯Ø´Øª Ø§Ø³Øª.')) {
                    this.storage.clearAllUsers();
                    this.updateAdminPanel();
                    this.updateOnlineUsersDisplay();
                    this.showNotification('ØªÙ…Ø§Ù… Ú©Ø§Ø±Ø¨Ø±Ø§Ù† Ø­Ø°Ù Ø´Ø¯Ù†Ø¯', 'success');
                }
            }
            
            adminClearAllMessages() {
                if (confirm('Ø¢ÛŒØ§ Ø§Ø² Ø­Ø°Ù ØªÙ…Ø§Ù… Ù¾ÛŒØ§Ù…â€ŒÙ‡Ø§ Ù…Ø·Ù…Ø¦Ù† Ù‡Ø³ØªÛŒØ¯ØŸ Ø§ÛŒÙ† Ø¹Ù…Ù„ ØºÛŒØ±Ù‚Ø§Ø¨Ù„ Ø¨Ø§Ø²Ú¯Ø´Øª Ø§Ø³Øª.')) {
                    this.storage.clearAllMessages();
                    this.loadMessages();
                    this.updateAdminPanel();
                    this.showNotification('ØªÙ…Ø§Ù… Ù¾ÛŒØ§Ù…â€ŒÙ‡Ø§ Ø­Ø°Ù Ø´Ø¯Ù†Ø¯', 'success');
                }
            }
            
            adminClearInactiveUsers() {
                const users = this.storage.getUsers();
                const now = new Date();
                let deletedCount = 0;
                
                users.forEach(user => {
                    if (user.username === 'admin') return;
                    
                    const lastSeen = new Date(user.lastSeen);
                    const diffDays = (now - lastSeen) / (1000 * 60 * 60 * 24);
                    
                    if (diffDays > 30) { // Ú©Ø§Ø±Ø¨Ø±Ø§Ù† ØºÛŒØ±ÙØ¹Ø§Ù„ Ø¨ÛŒØ´ Ø§Ø² 30 Ø±ÙˆØ²
                        this.storage.deleteUser(user.id);
                        deletedCount++;
                    }
                });
                
                this.updateAdminPanel();
                this.updateOnlineUsersDisplay();
                this.showNotification(`${deletedCount} Ú©Ø§Ø±Ø¨Ø± ØºÛŒØ±ÙØ¹Ø§Ù„ Ø­Ø°Ù Ø´Ø¯Ù†Ø¯`, 'success');
            }
            
            adminClearOldMessages() {
                const messages = this.storage.getMessages();
                const now = new Date();
                let deletedCount = 0;
                
                messages.forEach(message => {
                    const messageDate = new Date(message.timestamp);
                    const diffDays = (now - messageDate) / (1000 * 60 * 60 * 24);
                    
                    if (diffDays > 7) { // Ù¾ÛŒØ§Ù…â€ŒÙ‡Ø§ÛŒ Ù‚Ø¯ÛŒÙ…ÛŒâ€ŒØªØ± Ø§Ø² 7 Ø±ÙˆØ²
                        this.storage.deleteMessage(message.id);
                        deletedCount++;
                    }
                });
                
                this.loadMessages();
                this.updateAdminPanel();
                this.showNotification(`${deletedCount} Ù¾ÛŒØ§Ù… Ù‚Ø¯ÛŒÙ…ÛŒ Ø­Ø°Ù Ø´Ø¯Ù†Ø¯`, 'success');
            }
            
            adminExportUsers() {
                const users = this.storage.getUsers();
                const data = users.map(user => ({
                    username: user.username,
                    anonymousId: user.anonymousId,
                    registeredAt: user.registeredAt,
                    lastSeen: user.lastSeen,
                    messageCount: user.messageCount || 0
                }));
                
                this.exportToFile(data, 'users.json');
                this.showNotification('Ù„ÛŒØ³Øª Ú©Ø§Ø±Ø¨Ø±Ø§Ù† ØµØ§Ø¯Ø± Ø´Ø¯', 'success');
            }
            
            adminExportMessages() {
                const messages = this.storage.getMessages();
                const data = messages.map(message => ({
                    sender: message.senderId,
                    text: message.text,
                    timestamp: message.timestamp,
                    originalSender: message.senderUsername
                }));
                
                this.exportToFile(data, 'messages.json');
                this.showNotification('Ù„ÛŒØ³Øª Ù¾ÛŒØ§Ù…â€ŒÙ‡Ø§ ØµØ§Ø¯Ø± Ø´Ø¯', 'success');
            }
            
            adminExportAllData() {
                const data = {
                    users: this.storage.getUsers().map(user => ({
                        username: user.username,
                        anonymousId: user.anonymousId,
                        registeredAt: user.registeredAt,
                        lastSeen: user.lastSeen
                    })),
                    messages: this.storage.getMessages().map(message => ({
                        sender: message.senderId,
                        text: message.text.substring(0, 100) + (message.text.length > 100 ? '...' : ''),
                        timestamp: message.timestamp
                    })),
                    exportDate: new Date().toISOString(),
                    totalUsers: this.storage.getUsers().length,
                    totalMessages: this.storage.getMessages().length
                };
                
                this.exportToFile(data, 'chat-backup.json');
                this.showNotification('Ù¾Ø´ØªÛŒØ¨Ø§Ù† Ú©Ø§Ù…Ù„ Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§ ØµØ§Ø¯Ø± Ø´Ø¯', 'success');
            }
            
            exportToFile(data, filename) {
                const jsonData = JSON.stringify(data, null, 2);
                const blob = new Blob([jsonData], { type: 'application/json' });
                const url = URL.createObjectURL(blob);
                
                const a = document.createElement('a');
                a.href = url;
                a.download = filename;
                document.body.appendChild(a);
                a.click();
                document.body.removeChild(a);
                URL.revokeObjectURL(url);
            }
            
            adminImportData() {
                this.showNotification('Ø§ÛŒÙ† Ù‚Ø§Ø¨Ù„ÛŒØª Ø¯Ø± Ù†Ø³Ø®Ù‡ Ø¨Ø¹Ø¯ÛŒ Ø§Ø¶Ø§ÙÙ‡ Ø®ÙˆØ§Ù‡Ø¯ Ø´Ø¯', 'info');
            }
            
            adminResetSystem() {
                if (confirm('âš ï¸ Ù‡Ø´Ø¯Ø§Ø±: Ø¢ÛŒØ§ Ø§Ø² Ø¨Ø§Ø²Ù†Ø´Ø§Ù†ÛŒ Ú©Ø§Ù…Ù„ Ø³ÛŒØ³ØªÙ… Ù…Ø·Ù…Ø¦Ù† Ù‡Ø³ØªÛŒØ¯ØŸ\n\nØªÙ…Ø§Ù… Ú©Ø§Ø±Ø¨Ø±Ø§Ù† (Ø¨Ù‡ Ø¬Ø² Ø§Ø¯Ù…ÛŒÙ†) Ùˆ ØªÙ…Ø§Ù… Ù¾ÛŒØ§Ù…â€ŒÙ‡Ø§ Ø­Ø°Ù Ø®ÙˆØ§Ù‡Ù†Ø¯ Ø´Ø¯.\nØ§ÛŒÙ† Ø¹Ù…Ù„ ØºÛŒØ±Ù‚Ø§Ø¨Ù„ Ø¨Ø§Ø²Ú¯Ø´Øª Ø§Ø³Øª!')) {
                    this.storage.resetSystem();
                    
                    // Ø¨Ø§Ø²Ù†Ø´Ø§Ù†ÛŒ Ø±Ø§Ø¨Ø· Ú©Ø§Ø±Ø¨Ø±ÛŒ
                    this.logout();
                    this.loadMessages();
                    this.updateAdminPanel();
                    this.updateOnlineUsersDisplay();
                    
                    this.showNotification('Ø³ÛŒØ³ØªÙ… Ø¨Ø§ Ù…ÙˆÙÙ‚ÛŒØª Ø¨Ø§Ø²Ù†Ø´Ø§Ù†ÛŒ Ø´Ø¯', 'success');
                }
            }
        }

        // Ø³ÛŒØ³ØªÙ… Ø°Ø®ÛŒØ±Ù‡â€ŒØ³Ø§Ø²ÛŒ Ù¾ÛŒØ´Ø±ÙØªÙ‡
        class EnhancedStorage {
            constructor() {
                this.USERS_KEY = 'secure_chat_users_v2';
                this.MESSAGES_KEY = 'secure_chat_messages_v2';
                this.CURRENT_USER_KEY = 'secure_chat_current_user_v2';
                this.ADMIN_KEY = 'secure_chat_admin_config';
                
                this.initAdmin();
            }
            
            initAdmin() {
                let admin = localStorage.getItem(this.ADMIN_KEY);
                if (!admin) {
                    const defaultAdmin = {
                        username: 'admin',
                        password: 'Admin@1234',
                        secret: 'CHAT-SECURE-2024',
                        created: new Date().toISOString()
                    };
                    localStorage.setItem(this.ADMIN_KEY, JSON.stringify(defaultAdmin));
                }
            }
            
            getAdminData() {
                const admin = localStorage.getItem(this.ADMIN_KEY);
                return admin ? JSON.parse(admin) : null;
            }
            
            getUsers() {
                const users = localStorage.getItem(this.USERS_KEY);
                return users ? JSON.parse(users) : [];
            }
            
            saveUser(user) {
                const users = this.getUsers();
                const existingIndex = users.findIndex(u => u.id === user.id);
                
                if (existingIndex >= 0) {
                    users[existingIndex] = user;
                } else {
                    users.push(user);
                }
                
                localStorage.setItem(this.USERS_KEY, JSON.stringify(users));
            }
            
            updateUser(user) {
                this.saveUser(user);
            }
            
            deleteUser(userId) {
                let users = this.getUsers();
                users = users.filter(user => user.id !== userId);
                localStorage.setItem(this.USERS_KEY, JSON.stringify(users));
            }
            
            clearAllUsers() {
                const adminUser = this.getUsers().find(user => user.username === 'admin');
                const usersToKeep = adminUser ? [adminUser] : [];
                localStorage.setItem(this.USERS_KEY, JSON.stringify(usersToKeep));
            }
            
            getMessages() {
                const messages = localStorage.getItem(this.MESSAGES_KEY);
                return messages ? JSON.parse(messages) : [];
            }
            
            saveMessage(message) {
                const messages = this.getMessages();
                messages.push(message);
                localStorage.setItem(this.MESSAGES_KEY, JSON.stringify(messages));
            }
            
            deleteMessage(messageId) {
                let messages = this.getMessages();
                messages = messages.filter(msg => msg.id !== messageId);
                localStorage.setItem(this.MESSAGES_KEY, JSON.stringify(messages));
            }
            
            clearAllMessages() {
                localStorage.setItem(this.MESSAGES_KEY, JSON.stringify([]));
            }
            
            getCurrentUser() {
                const user = localStorage.getItem(this.CURRENT_USER_KEY);
                return user ? JSON.parse(user) : null;
            }
            
            setCurrentUser(user) {
                localStorage.setItem(this.CURRENT_USER_KEY, JSON.stringify(user));
            }
            
            clearCurrentUser() {
                localStorage.removeItem(this.CURRENT_USER_KEY);
            }
            
            resetSystem() {
                this.clearAllUsers();
                this.clearAllMessages();
                this.clearCurrentUser();
                this.initAdmin(); // Ø§Ø¯Ù…ÛŒÙ† Ø±Ø§ Ù†Ú¯Ù‡ Ø¯Ø§Ø±
            }
            
            // Ø§Ø¨Ø²Ø§Ø± Ú©Ù…Ú©ÛŒ
            generateId() {
                return Date.now().toString(36) + Math.random().toString(36).substr(2);
            }
        }

        // Ø±Ø§Ù‡â€ŒØ§Ù†Ø¯Ø§Ø²ÛŒ Ø¨Ø±Ù†Ø§Ù…Ù‡
        const chat = new SecureAnonymousChat();
        
        // ØªÙˆØ§Ø¨Ø¹ Ø¹Ù…ÙˆÙ…ÛŒ Ø¨Ø±Ø§ÛŒ Ø¯Ø³ØªØ±Ø³ÛŒ Ø§Ø² HTML
        window.chat = chat;
    </script>
</body>
    </html>
